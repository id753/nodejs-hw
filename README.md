# Express-додаток для роботи з колекцією нотаток
## Продовжено роботу над Express-додатком з підключенням реальної бази даних MongoDB через Mongoose. 
### Реалізовано реєстрацію, логін, логаут користувачів, сесії, кукі та приватні колекції нотаток.

Модель користувача. У файлі src/models/user.js створено модель User із такими властивостями:

    username — рядок, не обов’язкове поле, з параметром trim: true;
    email — рядок, унікальне, обов’язкове, з параметром trim: true;
    password — рядок, обов’язкове, мінімальна довжина — 8 символів.


Для автоматичного створення полів createdAt та updatedAt, використано параметр timestamps: true при створенні моделі.</br>
Додано до схеми userSchema метод toJSON, щоб видаляти пароль із об'єкта користувача перед відправкою у відповідь.</br>
Створено хук pre('save'), щоб за замовчуванням встановлювати username таким самим, як email, при створенні користувача.</br>
Модель сесії</br>
Константи часу</br>
Допоміжні функції. У src/services/auth.js реалізовано дві функції:

    createSession(userId) — створює access та refresh токени, створює сесію в базі даних і повертає її;
    setSessionCookies(res, session) — додає до відповіді три кукі:
    accessToken
    refreshToken
    sessionId

Використано библиотеку cookie-parser.</br>

Реєстрація користувача. У файлі у src/routes/authRoutes.js реалізовао маршрут POST /auth/register для реєстрації нового користувача.</br>

Додано валідацію вхідних даних за допомогою бібліотеки celebrate.</br>

Логін користувача. У файлі у src/routes/authRoutes.js реалізовано маршрут POST /auth/login для логіну зареєстрованого користувача.</br>

Оновлення сесії. У файлі у src/routes/authRoutes.js реалізовано маршрут POST /auth/refreshдля для оновлення сесії користувача.</br>

Логаут користувача. У файлі src/routes/authRoutes.js реалізовано маршрут POST /auth/logout для виходу користувача із системи.</br>

Middleware аутентифікації. У файлі src/middlewares/authenticate.js створено middleware authenticate, який:

    перевіряє наявність кукі accessToken;
    перевіряє, чи не прострочений access-токен;
    шукає користувача, пов’язаного з цією сесією. Якщо такий користувач не знайдено — повертає через createHttpError помилку зі статусом 401 без повідомлення;
    у разі успіху додає об’єкт знайденого користувача в req.user і викликає next().

Цей middleware застосований до всіх роутів нотаток, щоб забезпечити доступ лише для авторизованих користувачів.</br>
Колекція нотаток. Розширено модель Note обов’язковим полем userId (тип ObjectId, посилання на модель User).</br>
Для терміну дії та параметра кукі maxAge використовуються часові константи.</br>


Фільтрація. Використовуючи текстовий індекс MongoDB додано можливість фільтрування колекції нотаток до маршруту GET /notes за тегом та текстом через параметри рядка запиту (search, tag).</br>
Пагінація. Додано можливість пагінації до маршруту GET /notes через параметри рядка запиту (page, perPage).</br>
Валідація. Додано валідацію вхідних даних за допомогою бібліотеки celebrate https://www.npmjs.com/package/celebrate.</br>

Добре реалізовані аспекти:

    Коректне використання ES-модулів та імпортів.
    Змінні середовища завантажуються за допомогою 'dotenv/config'.
    CORS увімкнено для всіх маршрутів.
    Створено свій кластер в mongodb та функцію connectMongoDB для встановлення зʼєднання з нею в окремому файлі.
    При створенні кластеру в MongoDB Atlas налаштовано доступ до мережі, щоб дозволити підключення з будь-якої IP-адреси. 
    Для роботи з mongodb використано пакет mongoose (https://www.npmjs.com/package/mongoose)
    Сервер коректно підключається до MongoDB
    Middleware - додаток має використовувати стандартні middleware та бути грамотно організованим на рівні головного файлу src/server.js.
    - logger.js — логування HTTP-запитів за допомогою pino-http,
    - notFoundHandler.js — обробка всіх запитів на неіснуючі маршрути.
    - errorHandler.js — глобальна обробка помилок: повертає статус 500, або інші статуси у разі використання бібліотеки http-errors.
    Модель Noteю Створено файл note.js із Mongoose-схемою. 
    Порт та адреса бази зберігаються у .env через змінні PORT та MONGO_URL
    Повідомлення про запуск сервера показує порт.
    Безпечні токени генеруються з використанням crypto.randomBytes.
    Задеплоєно проєкт на render.com
